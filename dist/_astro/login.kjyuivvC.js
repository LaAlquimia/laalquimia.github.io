import{a as ie,i as ae,u as ge}from"./store.a--R0Znl.js";import{y as de,z as R,A as h,B as l,D as y,E as oe,F as pe,G as be,H as G,I as Q,J as k,N as b,K as x,L as we,M as W,O as X,P as ye,Q as ke,R as Re,T as ce,U as Ee,V as Ne,C as ue,W as _e,X as Z,Y,Z as Se}from"./provider-jsonrpc.Dt8PGCDP.js";const Te=BigInt(-1),d=BigInt(0),N=BigInt(1),ve=BigInt(5),E={};let _="0000";for(;_.length<80;)_+=_;function w(n){let e=_;for(;e.length<n;)e+=e;return BigInt("1"+e.substring(0,n))}function S(n,e,t){const r=BigInt(e.width);if(e.signed){const s=N<<r-N;l(t==null||n>=-s&&n<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:n}),n>d?n=G(Q(n,r),r):n=-G(Q(-n,r),r)}else{const s=N<<r;l(t==null||n>=0&&n<s,"overflow","NUMERIC_FAULT",{operation:t,fault:"overflow",value:n}),n=(n%s+s)%s&s-N}return n}function $(n){typeof n=="number"&&(n=`fixed128x${n}`);let e=!0,t=128,r=18;if(typeof n=="string"){if(n!=="fixed")if(n==="ufixed")e=!1;else{const i=n.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);h(i,"invalid fixed format","format",n),e=i[1]!=="u",t=parseInt(i[2]),r=parseInt(i[3])}}else if(n){const i=n,a=(o,c,u)=>i[o]==null?u:(h(typeof i[o]===c,"invalid fixed format ("+o+" not "+c+")","format."+o,i[o]),i[o]);e=a("signed","boolean",e),t=a("width","number",t),r=a("decimals","number",r)}h(t%8===0,"invalid FixedNumber width (not byte aligned)","format.width",t),h(r<=80,"invalid FixedNumber decimals (too large)","format.decimals",r);const s=(e?"":"u")+"fixed"+String(t)+"x"+String(r);return{signed:e,width:t,decimals:r,name:s}}function Pe(n,e){let t="";n<d&&(t="-",n*=Te);let r=n.toString();if(e===0)return t+r;for(;r.length<=e;)r=_+r;const s=r.length-e;for(r=r.substring(0,s)+"."+r.substring(s);r[0]==="0"&&r[1]!==".";)r=r.substring(1);for(;r[r.length-1]==="0"&&r[r.length-2]!==".";)r=r.substring(0,r.length-1);return t+r}class p{format;#e;#t;#r;_value;constructor(e,t,r){de(e,E,"FixedNumber"),this.#t=t,this.#e=r;const s=Pe(t,r.decimals);R(this,{format:r.name,_value:s}),this.#r=w(r.decimals)}get signed(){return this.#e.signed}get width(){return this.#e.width}get decimals(){return this.#e.decimals}get value(){return this.#t}#n(e){h(this.format===e.format,"incompatible format; use fixedNumber.toFormat","other",e)}#s(e,t){return e=S(e,this.#e,t),new p(E,e,this.#e)}#a(e,t){return this.#n(e),this.#s(this.#t+e.#t,t)}addUnsafe(e){return this.#a(e)}add(e){return this.#a(e,"add")}#o(e,t){return this.#n(e),this.#s(this.#t-e.#t,t)}subUnsafe(e){return this.#o(e)}sub(e){return this.#o(e,"sub")}#i(e,t){return this.#n(e),this.#s(this.#t*e.#t/this.#r,t)}mulUnsafe(e){return this.#i(e)}mul(e){return this.#i(e,"mul")}mulSignal(e){this.#n(e);const t=this.#t*e.#t;return l(t%this.#r===d,"precision lost during signalling mul","NUMERIC_FAULT",{operation:"mulSignal",fault:"underflow",value:this}),this.#s(t/this.#r,"mulSignal")}#c(e,t){return l(e.#t!==d,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#n(e),this.#s(this.#t*this.#r/e.#t,t)}divUnsafe(e){return this.#c(e)}div(e){return this.#c(e,"div")}divSignal(e){l(e.#t!==d,"division by zero","NUMERIC_FAULT",{operation:"div",fault:"divide-by-zero",value:this}),this.#n(e);const t=this.#t*this.#r;return l(t%e.#t===d,"precision lost during signalling div","NUMERIC_FAULT",{operation:"divSignal",fault:"underflow",value:this}),this.#s(t/e.#t,"divSignal")}cmp(e){let t=this.value,r=e.value;const s=this.decimals-e.decimals;return s>0?r*=w(s):s<0&&(t*=w(-s)),t<r?-1:t>r?1:0}eq(e){return this.cmp(e)===0}lt(e){return this.cmp(e)<0}lte(e){return this.cmp(e)<=0}gt(e){return this.cmp(e)>0}gte(e){return this.cmp(e)>=0}floor(){let e=this.#t;return this.#t<d&&(e-=this.#r-N),e=this.#t/this.#r*this.#r,this.#s(e,"floor")}ceiling(){let e=this.#t;return this.#t>d&&(e+=this.#r-N),e=this.#t/this.#r*this.#r,this.#s(e,"ceiling")}round(e){if(e==null&&(e=0),e>=this.decimals)return this;const t=this.decimals-e,r=ve*w(t-1);let s=this.value+r;const i=w(t);return s=s/i*i,S(s,this.#e,"round"),new p(E,s,this.#e)}isZero(){return this.#t===d}isNegative(){return this.#t<d}toString(){return this._value}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(e){return p.fromString(this.toString(),e)}static fromValue(e,t,r){const s=t==null?0:y(t),i=$(r);let a=oe(e,"value");const o=s-i.decimals;if(o>0){const c=w(o);l(a%c===d,"value loses precision for format","NUMERIC_FAULT",{operation:"fromValue",fault:"underflow",value:e}),a/=c}else o<0&&(a*=w(-o));return S(a,i,"fromValue"),new p(E,a,i)}static fromString(e,t){const r=e.match(/^(-?)([0-9]*)\.?([0-9]*)$/);h(r&&r[2].length+r[3].length>0,"invalid FixedNumber string value","value",e);const s=$(t);let i=r[2]||"0",a=r[3]||"";for(;a.length<s.decimals;)a+=_;l(a.substring(s.decimals).match(/^0*$/),"too many decimals for format","NUMERIC_FAULT",{operation:"fromString",fault:"underflow",value:e}),a=a.substring(0,s.decimals);const o=BigInt(r[1]+i+a);return S(o,s,"fromString"),new p(E,o,s)}static fromBytes(e,t){let r=pe(be(e,"value"));const s=$(t);return s.signed&&(r=G(r,s.width)),S(r,s,"fromBytes"),new p(E,r,s)}}const le=["wei","kwei","mwei","gwei","szabo","finney","ether"];function he(n,e){let t=18;if(typeof e=="string"){const r=le.indexOf(e);h(r>=0,"invalid unit","unit",e),t=3*r}else e!=null&&(t=y(e,"unit"));return p.fromValue(n,t,{decimals:t,width:512}).toString()}function it(n,e){h(typeof n=="string","value must be a string","value",n);let t=18;if(typeof e=="string"){const r=le.indexOf(e);h(r>=0,"invalid unit","unit",e),t=3*r}else e!=null&&(t=y(e,"unit"));return p.fromString(n,{decimals:t,width:512}).value}function at(n){return he(n,18)}const ee=new Set;function O(n){ee.has(n)||(ee.add(n),console.log("========= NOTICE ========="),console.log(`Request-Rate Exceeded for ${n} (this message will not be repeated)`),console.log(""),console.log("The default API keys for each service are provided as a highly-throttled,"),console.log("community resource for low-traffic projects and early prototyping."),console.log(""),console.log("While your application will continue to function, we highly recommended"),console.log("signing up for your own API keys to improve performance, increase your"),console.log("request rate/limit and enable other perks, such as metrics and advanced APIs."),console.log(""),console.log("For more details: https://docs.ethers.org/api-keys/"),console.log("=========================="))}const I="9f7d929b018cdffb338517efa06f58359e86ff1ffd350bc889738523659e7972";function xe(n){switch(n){case"mainnet":return"rpc.ankr.com/eth";case"goerli":return"rpc.ankr.com/eth_goerli";case"sepolia":return"rpc.ankr.com/eth_sepolia";case"arbitrum":return"rpc.ankr.com/arbitrum";case"base":return"rpc.ankr.com/base";case"base-goerli":return"rpc.ankr.com/base_goerli";case"base-sepolia":return"rpc.ankr.com/base_sepolia";case"bnb":return"rpc.ankr.com/bsc";case"bnbt":return"rpc.ankr.com/bsc_testnet_chapel";case"matic":return"rpc.ankr.com/polygon";case"matic-mumbai":return"rpc.ankr.com/polygon_mumbai";case"optimism":return"rpc.ankr.com/optimism";case"optimism-goerli":return"rpc.ankr.com/optimism_testnet";case"optimism-sepolia":return"rpc.ankr.com/optimism_sepolia"}h(!1,"unsupported network","network",n)}class B extends k{apiKey;constructor(e,t){e==null&&(e="mainnet");const r=b.from(e);t==null&&(t=I);const s={polling:!0,staticNetwork:r},i=B.getRequest(r,t);super(i,r,s),R(this,{apiKey:t})}_getProvider(e){try{return new B(e,this.apiKey)}catch{}return super._getProvider(e)}static getRequest(e,t){t==null&&(t=I);const r=new x(`https://${xe(e.name)}/${t}`);return r.allowGzip=!0,t===I&&(r.retryFunc=async(s,i,a)=>(O("AnkrProvider"),!0)),r}getRpcError(e,t){return e.method==="eth_sendRawTransaction"&&t&&t.error&&t.error.message==="INTERNAL_ERROR: could not replace existing tx"&&(t.error.message="replacement transaction underpriced"),super.getRpcError(e,t)}isCommunityResource(){return this.apiKey===I}}const C="_gg7wSSi0KMBsdKnGVfHDueq6xMB9EkC";function Oe(n){switch(n){case"mainnet":return"eth-mainnet.alchemyapi.io";case"goerli":return"eth-goerli.g.alchemy.com";case"sepolia":return"eth-sepolia.g.alchemy.com";case"arbitrum":return"arb-mainnet.g.alchemy.com";case"arbitrum-goerli":return"arb-goerli.g.alchemy.com";case"arbitrum-sepolia":return"arb-sepolia.g.alchemy.com";case"base":return"base-mainnet.g.alchemy.com";case"base-goerli":return"base-goerli.g.alchemy.com";case"base-sepolia":return"base-sepolia.g.alchemy.com";case"matic":return"polygon-mainnet.g.alchemy.com";case"matic-mumbai":return"polygon-mumbai.g.alchemy.com";case"optimism":return"opt-mainnet.g.alchemy.com";case"optimism-goerli":return"opt-goerli.g.alchemy.com";case"optimism-sepolia":return"opt-sepolia.g.alchemy.com"}h(!1,"unsupported network","network",n)}class A extends k{apiKey;constructor(e,t){e==null&&(e="mainnet");const r=b.from(e);t==null&&(t=C);const s=A.getRequest(r,t);super(s,r,{staticNetwork:r}),R(this,{apiKey:t})}_getProvider(e){try{return new A(e,this.apiKey)}catch{}return super._getProvider(e)}async _perform(e){if(e.method==="getTransactionResult"){const{trace:t,tx:r}=await we({trace:this.send("trace_transaction",[e.hash]),tx:this.getTransaction(e.hash)});if(t==null||r==null)return null;let s,i=!1;try{s=t[0].result.output,i=t[0].error==="Reverted"}catch{}if(s)return l(!i,"an error occurred during transaction executions","CALL_EXCEPTION",{action:"getTransactionResult",data:s,reason:null,transaction:r,invocation:null,revert:null}),s;l(!1,"could not parse trace result","BAD_DATA",{value:t})}return await super._perform(e)}isCommunityResource(){return this.apiKey===C}static getRequest(e,t){t==null&&(t=C);const r=new x(`https://${Oe(e.name)}/v2/${t}`);return r.allowGzip=!0,t===C&&(r.retryFunc=async(s,i,a)=>(O("alchemy"),!0)),r}}class Ie extends k{constructor(e){e==null&&(e="mainnet");const t=b.from(e);h(t.name==="mainnet","unsupported network","network",e),super("https://cloudflare-eth.com/",t,{staticNetwork:t})}}const te=2e3;function Ce(n){return n&&typeof n.then=="function"}const Fe="org.ethers.plugins.provider.Etherscan",Ue=["enableCcipRead"];let Be=1;class Ae extends W{network;apiKey;#e;constructor(e,t){const r=t??null;super();const s=b.from(e);this.#e=s.getPlugin(Fe),R(this,{apiKey:r,network:s}),this.getBaseUrl()}getBaseUrl(){if(this.#e)return this.#e.baseUrl;switch(this.network.name){case"mainnet":return"https://api.etherscan.io";case"goerli":return"https://api-goerli.etherscan.io";case"sepolia":return"https://api-sepolia.etherscan.io";case"holesky":return"https://api-holesky.etherscan.io";case"arbitrum":return"https://api.arbiscan.io";case"arbitrum-goerli":return"https://api-goerli.arbiscan.io";case"bnb":return"https://api.bscscan.com";case"bnbt":return"https://api-testnet.bscscan.com";case"matic":return"https://api.polygonscan.com";case"matic-mumbai":return"https://api-testnet.polygonscan.com";case"optimism":return"https://api-optimistic.etherscan.io";case"optimism-goerli":return"https://api-goerli-optimistic.etherscan.io"}h(!1,"unsupported network","network",this.network)}getUrl(e,t){const r=Object.keys(t).reduce((i,a)=>{const o=t[a];return o!=null&&(i+=`&${a}=${o}`),i},""),s=this.apiKey?`&apikey=${this.apiKey}`:"";return`${this.getBaseUrl()}/api?module=${e}${r}${s}`}getPostUrl(){return`${this.getBaseUrl()}/api`}getPostData(e,t){return t.module=e,t.apikey=this.apiKey,t}async detectNetwork(){return this.network}async fetch(e,t,r){const s=Be++,i=r?this.getPostUrl():this.getUrl(e,t),a=r?this.getPostData(e,t):null;this.emit("debug",{action:"sendRequest",id:s,url:i,payload:a});const o=new x(i);o.setThrottleParams({slotInterval:1e3}),o.retryFunc=(m,f,g)=>(this.isCommunityResource()&&O("Etherscan"),Promise.resolve(!0)),o.processFunc=async(m,f)=>{const g=f.hasBody()?JSON.parse(X(f.body)):{},H=(typeof g.result=="string"?g.result:"").toLowerCase().indexOf("rate limit")>=0;return e==="proxy"?g&&g.status==0&&g.message=="NOTOK"&&H&&(this.emit("debug",{action:"receiveError",id:s,reason:"proxy-NOTOK",error:g}),f.throwThrottleError(g.result,te)):H&&(this.emit("debug",{action:"receiveError",id:s,reason:"null result",error:g.result}),f.throwThrottleError(g.result,te)),f},a&&(o.setHeader("content-type","application/x-www-form-urlencoded; charset=UTF-8"),o.body=Object.keys(a).map(m=>`${m}=${a[m]}`).join("&"));const c=await o.send();try{c.assertOk()}catch(m){this.emit("debug",{action:"receiveError",id:s,error:m,reason:"assertOk"}),l(!1,"response error","SERVER_ERROR",{request:o,response:c})}c.hasBody()||(this.emit("debug",{action:"receiveError",id:s,error:"missing body",reason:"null body"}),l(!1,"missing response","SERVER_ERROR",{request:o,response:c}));const u=JSON.parse(X(c.body));return e==="proxy"?(u.jsonrpc!="2.0"&&(this.emit("debug",{action:"receiveError",id:s,result:u,reason:"invalid JSON-RPC"}),l(!1,"invalid JSON-RPC response (missing jsonrpc='2.0')","SERVER_ERROR",{request:o,response:c,info:{result:u}})),u.error&&(this.emit("debug",{action:"receiveError",id:s,result:u,reason:"JSON-RPC error"}),l(!1,"error response","SERVER_ERROR",{request:o,response:c,info:{result:u}})),this.emit("debug",{action:"receiveRequest",id:s,result:u}),u.result):u.status==0&&(u.message==="No records found"||u.message==="No transactions found")?(this.emit("debug",{action:"receiveRequest",id:s,result:u}),u.result):((u.status!=1||typeof u.message=="string"&&!u.message.match(/^OK/))&&(this.emit("debug",{action:"receiveError",id:s,result:u}),l(!1,"error response","SERVER_ERROR",{request:o,response:c,info:{result:u}})),this.emit("debug",{action:"receiveRequest",id:s,result:u}),u.result)}_getTransactionPostData(e){const t={};for(let r in e){if(Ue.indexOf(r)>=0||e[r]==null)continue;let s=e[r];r==="type"&&s===0||r==="blockTag"&&s==="latest"||({type:!0,gasLimit:!0,gasPrice:!0,maxFeePerGs:!0,maxPriorityFeePerGas:!0,nonce:!0,value:!0}[r]?s=ye(s):r==="accessList"?s="["+ke(s).map(i=>`{address:"${i.address}",storageKeys:["${i.storageKeys.join('","')}"]}`).join(",")+"]":s=Re(s),t[r]=s)}return t}_checkError(e,t,r){let s="";if(ce(t,"SERVER_ERROR")){try{s=t.info.result.error.message}catch{}if(!s)try{s=t.info.message}catch{}}if(e.method==="estimateGas"&&!s.match(/revert/i)&&s.match(/insufficient funds/i)&&l(!1,"insufficient funds","INSUFFICIENT_FUNDS",{transaction:e.transaction}),(e.method==="call"||e.method==="estimateGas")&&s.match(/execution reverted/i)){let i="";try{i=t.info.result.error.data}catch{}const a=Ee.getBuiltinCallException(e.method,e.transaction,i);throw a.info={request:e,error:t},a}if(s&&e.method==="broadcastTransaction"){const i=Ne.from(e.signedTransaction);s.match(/replacement/i)&&s.match(/underpriced/i)&&l(!1,"replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:i}),s.match(/insufficient funds/)&&l(!1,"insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:i}),s.match(/same hash was already imported|transaction nonce is too low|nonce too low/)&&l(!1,"nonce has already been used","NONCE_EXPIRED",{transaction:i})}throw t}async _detectNetwork(){return this.network}async _perform(e){switch(e.method){case"chainId":return this.network.chainId;case"getBlockNumber":return this.fetch("proxy",{action:"eth_blockNumber"});case"getGasPrice":return this.fetch("proxy",{action:"eth_gasPrice"});case"getPriorityFee":if(this.network.name==="mainnet")return"1000000000";if(this.network.name==="optimism")return"1000000";throw new Error("fallback onto the AbstractProvider default");case"getBalance":return this.fetch("account",{action:"balance",address:e.address,tag:e.blockTag});case"getTransactionCount":return this.fetch("proxy",{action:"eth_getTransactionCount",address:e.address,tag:e.blockTag});case"getCode":return this.fetch("proxy",{action:"eth_getCode",address:e.address,tag:e.blockTag});case"getStorage":return this.fetch("proxy",{action:"eth_getStorageAt",address:e.address,position:e.position,tag:e.blockTag});case"broadcastTransaction":return this.fetch("proxy",{action:"eth_sendRawTransaction",hex:e.signedTransaction},!0).catch(t=>this._checkError(e,t,e.signedTransaction));case"getBlock":if("blockTag"in e)return this.fetch("proxy",{action:"eth_getBlockByNumber",tag:e.blockTag,boolean:e.includeTransactions?"true":"false"});l(!1,"getBlock by blockHash not supported by Etherscan","UNSUPPORTED_OPERATION",{operation:"getBlock(blockHash)"});case"getTransaction":return this.fetch("proxy",{action:"eth_getTransactionByHash",txhash:e.hash});case"getTransactionReceipt":return this.fetch("proxy",{action:"eth_getTransactionReceipt",txhash:e.hash});case"call":{if(e.blockTag!=="latest")throw new Error("EtherscanProvider does not support blockTag for call");const t=this._getTransactionPostData(e.transaction);t.module="proxy",t.action="eth_call";try{return await this.fetch("proxy",t,!0)}catch(r){return this._checkError(e,r,e.transaction)}}case"estimateGas":{const t=this._getTransactionPostData(e.transaction);t.module="proxy",t.action="eth_estimateGas";try{return await this.fetch("proxy",t,!0)}catch(r){return this._checkError(e,r,e.transaction)}}}return super._perform(e)}async getNetwork(){return this.network}async getEtherPrice(){return this.network.name!=="mainnet"?0:parseFloat((await this.fetch("stats",{action:"ethprice"})).ethusd)}async getContract(e){let t=this._getAddress(e);Ce(t)&&(t=await t);try{const r=await this.fetch("contract",{action:"getabi",address:t}),s=JSON.parse(r);return new ue(t,s,this)}catch{return null}}isCommunityResource(){return this.apiKey==null}}function Me(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}const $e=Me().WebSocket;class V{#e;#t;get filter(){return JSON.parse(this.#t)}#r;#n;#s;constructor(e,t){this.#e=e,this.#t=JSON.stringify(t),this.#r=null,this.#n=null,this.#s=null}start(){this.#r=this.#e.send("eth_subscribe",this.filter).then(e=>(this.#e._register(e,this),e))}stop(){this.#r.then(e=>{this.#e.send("eth_unsubscribe",[e])}),this.#r=null}pause(e){l(e,"preserve logs while paused not supported by SocketSubscriber yet","UNSUPPORTED_OPERATION",{operation:"pause(false)"}),this.#n=!!e}resume(){this.#n=null}_handleMessage(e){if(this.#r!=null&&this.#n===null){let t=this.#s;t==null?t=this._emit(this.#e,e):t=t.then(async()=>{await this._emit(this.#e,e)}),this.#s=t.then(()=>{this.#s===t&&(this.#s=null)})}}async _emit(e,t){throw new Error("sub-classes must implemente this; _emit")}}class De extends V{constructor(e){super(e,["newHeads"])}async _emit(e,t){e.emit("block",parseInt(t.number))}}class je extends V{constructor(e){super(e,["newPendingTransactions"])}async _emit(e,t){e.emit("pending",t)}}class Le extends V{#e;get logFilter(){return JSON.parse(this.#e)}constructor(e,t){super(e,["logs",t]),this.#e=JSON.stringify(t)}async _emit(e,t){e.emit(this.logFilter,e._wrapLog(t,e._network))}}class qe extends _e{#e;#t;#r;constructor(e,t){const r=Object.assign({},t??{});h(r.batchMaxCount==null||r.batchMaxCount===1,"sockets-based providers do not support batches","options.batchMaxCount",t),r.batchMaxCount=1,r.staticNetwork==null&&(r.staticNetwork=!0),super(e,r),this.#e=new Map,this.#t=new Map,this.#r=new Map}_getSubscriber(e){switch(e.type){case"close":return new Z("close");case"block":return new De(this);case"pending":return new je(this);case"event":return new Le(this,e.filter);case"orphan":if(e.filter.orphan==="drop-log")return new Z("drop-log")}return super._getSubscriber(e)}_register(e,t){this.#t.set(e,t);const r=this.#r.get(e);if(r){for(const s of r)t._handleMessage(s);this.#r.delete(e)}}async _send(e){h(!Array.isArray(e),"WebSocket does not support batch send","payload",e);const t=new Promise((r,s)=>{this.#e.set(e.id,{payload:e,resolve:r,reject:s})});return await this._waitUntilReady(),await this._write(JSON.stringify(e)),[await t]}async _processMessage(e){const t=JSON.parse(e);if(t&&typeof t=="object"&&"id"in t){const r=this.#e.get(t.id);if(r==null){this.emit("error",Y("received result for unknown id","UNKNOWN_ERROR",{reasonCode:"UNKNOWN_ID",result:t}));return}this.#e.delete(t.id),r.resolve(t)}else if(t&&t.method==="eth_subscription"){const r=t.params.subscription,s=this.#t.get(r);if(s)s._handleMessage(t.params.result);else{let i=this.#r.get(r);i==null&&(i=[],this.#r.set(r,i)),i.push(t.params.result)}}else{this.emit("error",Y("received unexpected message","UNKNOWN_ERROR",{reasonCode:"UNEXPECTED_MESSAGE",result:t}));return}}async _write(e){throw new Error("sub-classes must override this")}}class fe extends qe{#e;#t;get websocket(){if(this.#t==null)throw new Error("websocket closed");return this.#t}constructor(e,t,r){super(t,r),typeof e=="string"?(this.#e=()=>new $e(e),this.#t=this.#e()):typeof e=="function"?(this.#e=e,this.#t=e()):(this.#e=null,this.#t=e),this.websocket.onopen=async()=>{try{await this._start(),this.resume()}catch(s){console.log("failed to start WebsocketProvider",s)}},this.websocket.onmessage=s=>{this._processMessage(s.data)}}async _write(e){this.websocket.send(e)}async destroy(){this.#t!=null&&(this.#t.close(),this.#t=null),super.destroy()}}const T="84842078b09946638c03157f83405213";function Je(n){switch(n){case"mainnet":return"mainnet.infura.io";case"goerli":return"goerli.infura.io";case"sepolia":return"sepolia.infura.io";case"arbitrum":return"arbitrum-mainnet.infura.io";case"arbitrum-goerli":return"arbitrum-goerli.infura.io";case"arbitrum-sepolia":return"arbitrum-sepolia.infura.io";case"base":return"base-mainnet.infura.io";case"base-goerlia":return"base-goerli.infura.io";case"base-sepolia":return"base-sepolia.infura.io";case"bnb":return"bnbsmartchain-mainnet.infura.io";case"bnbt":return"bnbsmartchain-testnet.infura.io";case"linea":return"linea-mainnet.infura.io";case"linea-goerli":return"linea-goerli.infura.io";case"matic":return"polygon-mainnet.infura.io";case"matic-mumbai":return"polygon-mumbai.infura.io";case"optimism":return"optimism-mainnet.infura.io";case"optimism-goerli":return"optimism-goerli.infura.io";case"optimism-sepolia":return"optimism-sepolia.infura.io"}h(!1,"unsupported network","network",n)}class Ge extends fe{projectId;projectSecret;constructor(e,t){const r=new P(e,t),s=r._getConnection();l(!s.credentials,"INFURA WebSocket project secrets unsupported","UNSUPPORTED_OPERATION",{operation:"InfuraProvider.getWebSocketProvider()"});const i=s.url.replace(/^http/i,"ws").replace("/v3/","/ws/v3/");super(i,e),R(this,{projectId:r.projectId,projectSecret:r.projectSecret})}isCommunityResource(){return this.projectId===T}}class P extends k{projectId;projectSecret;constructor(e,t,r){e==null&&(e="mainnet");const s=b.from(e);t==null&&(t=T),r==null&&(r=null);const i=P.getRequest(s,t,r);super(i,s,{staticNetwork:s}),R(this,{projectId:t,projectSecret:r})}_getProvider(e){try{return new P(e,this.projectId,this.projectSecret)}catch{}return super._getProvider(e)}isCommunityResource(){return this.projectId===T}static getWebSocketProvider(e,t){return new Ge(e,t)}static getRequest(e,t,r){t==null&&(t=T),r==null&&(r=null);const s=new x(`https://${Je(e.name)}/v3/${t}`);return s.allowGzip=!0,r&&s.setCredentials("",r),t===T&&(s.retryFunc=async(i,a,o)=>(O("InfuraProvider"),!0)),s}}const F="919b412a057b5e9c9b6dce193c5a60242d6efadb";function We(n){switch(n){case"mainnet":return"ethers.quiknode.pro";case"goerli":return"ethers.ethereum-goerli.quiknode.pro";case"sepolia":return"ethers.ethereum-sepolia.quiknode.pro";case"holesky":return"ethers.ethereum-holesky.quiknode.pro";case"arbitrum":return"ethers.arbitrum-mainnet.quiknode.pro";case"arbitrum-goerli":return"ethers.arbitrum-goerli.quiknode.pro";case"arbitrum-sepolia":return"ethers.arbitrum-sepolia.quiknode.pro";case"base":return"ethers.base-mainnet.quiknode.pro";case"base-goerli":return"ethers.base-goerli.quiknode.pro";case"base-spolia":return"ethers.base-sepolia.quiknode.pro";case"bnb":return"ethers.bsc.quiknode.pro";case"bnbt":return"ethers.bsc-testnet.quiknode.pro";case"matic":return"ethers.matic.quiknode.pro";case"matic-mumbai":return"ethers.matic-testnet.quiknode.pro";case"optimism":return"ethers.optimism.quiknode.pro";case"optimism-goerli":return"ethers.optimism-goerli.quiknode.pro";case"optimism-sepolia":return"ethers.optimism-sepolia.quiknode.pro";case"xdai":return"ethers.xdai.quiknode.pro"}h(!1,"unsupported network","network",n)}class M extends k{token;constructor(e,t){e==null&&(e="mainnet");const r=b.from(e);t==null&&(t=F);const s=M.getRequest(r,t);super(s,r,{staticNetwork:r}),R(this,{token:t})}_getProvider(e){try{return new M(e,this.token)}catch{}return super._getProvider(e)}isCommunityResource(){return this.token===F}static getRequest(e,t){t==null&&(t=F);const r=new x(`https://${We(e.name)}/${t}`);return r.allowGzip=!0,t===F&&(r.retryFunc=async(s,i,a)=>(O("QuickNodeProvider"),!0)),r}}const ze=BigInt("1"),Ke=BigInt("2");function Ve(n){for(let e=n.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1)),r=n[e];n[e]=n[t],n[t]=r}}function He(n){return new Promise(e=>{setTimeout(e,n)})}function z(){return new Date().getTime()}function D(n){return JSON.stringify(n,(e,t)=>typeof t=="bigint"?{type:"bigint",value:t.toString()}:t)}const re={stallTimeout:400,priority:1,weight:1},se={blockNumber:-2,requests:0,lateResponses:0,errorResponses:0,outOfSync:-1,unsupportedEvents:0,rollingDuration:0,score:0,_network:null,_updateNumber:null,_totalTime:0,_lastFatalError:null,_lastFatalErrorTimestamp:0};async function Qe(n,e){for(;(n.blockNumber<0||n.blockNumber<e)&&(n._updateNumber||(n._updateNumber=(async()=>{try{const t=await n.provider.getBlockNumber();t>n.blockNumber&&(n.blockNumber=t)}catch(t){n.blockNumber=-2,n._lastFatalError=t,n._lastFatalErrorTimestamp=z()}n._updateNumber=null})()),await n._updateNumber,n.outOfSync++,!n._lastFatalError););}function v(n){if(n==null)return"null";if(Array.isArray(n))return"["+n.map(v).join(",")+"]";if(typeof n=="object"&&typeof n.toJSON=="function")return v(n.toJSON());switch(typeof n){case"boolean":case"symbol":return n.toString();case"bigint":case"number":return BigInt(n).toString();case"string":return JSON.stringify(n);case"object":{const e=Object.keys(n);return e.sort(),"{"+e.map(t=>`${JSON.stringify(t)}:${v(n[t])}`).join(",")+"}"}}throw console.log("Could not serialize",n),new Error("Hmm...")}function j(n){if("error"in n){const t=n.error;return{tag:v(t),value:t}}const e=n.result;return{tag:v(e),value:e}}function U(n,e){const t=new Map;for(const{value:s,tag:i,weight:a}of e){const o=t.get(i)||{value:s,weight:0};o.weight+=a,t.set(i,o)}let r=null;for(const s of t.values())s.weight>=n&&(!r||s.weight>r.weight)&&(r=s);if(r)return r.value}function K(n,e){let t=0;const r=new Map;let s=null;const i=[];for(const{value:o,tag:c,weight:u}of e)if(o instanceof Error){const m=r.get(c)||{value:o,weight:0};m.weight+=u,r.set(c,m),(s==null||m.weight>s.weight)&&(s=m)}else i.push(BigInt(o)),t+=u;if(t<n)return s&&s.weight>=n?s.value:void 0;i.sort((o,c)=>o<c?-1:c>o?1:0);const a=Math.floor(i.length/2);return i.length%2?i[a]:(i[a-1]+i[a]+ze)/Ke}function L(n,e){const t=U(n,e);if(t!==void 0)return t;for(const r of e)if(r.value)return r.value}function Xe(n,e){if(n===1)return y(K(n,e),"%internal");const t=new Map,r=(a,o)=>{const c=t.get(a)||{result:a,weight:0};c.weight+=o,t.set(a,c)};for(const{weight:a,value:o}of e){const c=y(o);r(c-1,a),r(c,a),r(c+1,a)}let s=0,i;for(const{weight:a,result:o}of t.values())a>=n&&(a>s||i!=null&&a===s&&o>i)&&(s=a,i=o);return i}class Ze extends W{quorum;eventQuorum;eventWorkers;#e;#t;#r;constructor(e,t,r){super(t,r),this.#e=e.map(s=>s instanceof W?Object.assign({provider:s},re,se):Object.assign({},re,s,se)),this.#t=-2,this.#r=null,r&&r.quorum!=null?this.quorum=r.quorum:this.quorum=Math.ceil(this.#e.reduce((s,i)=>(s+=i.weight,s),0)/2),this.eventQuorum=1,this.eventWorkers=1,h(this.quorum<=this.#e.reduce((s,i)=>s+i.weight,0),"quorum exceed provider wieght","quorum",this.quorum)}get providerConfigs(){return this.#e.map(e=>{const t=Object.assign({},e);for(const r in t)r[0]==="_"&&delete t[r];return t})}async _detectNetwork(){return b.from(oe(await this._perform({method:"chainId"})))}async _translatePerform(e,t){switch(t.method){case"broadcastTransaction":return await e.broadcastTransaction(t.signedTransaction);case"call":return await e.call(Object.assign({},t.transaction,{blockTag:t.blockTag}));case"chainId":return(await e.getNetwork()).chainId;case"estimateGas":return await e.estimateGas(t.transaction);case"getBalance":return await e.getBalance(t.address,t.blockTag);case"getBlock":{const r="blockHash"in t?t.blockHash:t.blockTag;return await e.getBlock(r,t.includeTransactions)}case"getBlockNumber":return await e.getBlockNumber();case"getCode":return await e.getCode(t.address,t.blockTag);case"getGasPrice":return(await e.getFeeData()).gasPrice;case"getPriorityFee":return(await e.getFeeData()).maxPriorityFeePerGas;case"getLogs":return await e.getLogs(t.filter);case"getStorage":return await e.getStorage(t.address,t.position,t.blockTag);case"getTransaction":return await e.getTransaction(t.hash);case"getTransactionCount":return await e.getTransactionCount(t.address,t.blockTag);case"getTransactionReceipt":return await e.getTransactionReceipt(t.hash);case"getTransactionResult":return await e.getTransactionResult(t.hash)}}#n(e){const t=Array.from(e).map(s=>s.config),r=this.#e.slice();Ve(r),r.sort((s,i)=>s.priority-i.priority);for(const s of r)if(!s._lastFatalError&&t.indexOf(s)===-1)return s;return null}#s(e,t){const r=this.#n(e);if(r==null)return null;const s={config:r,result:null,didBump:!1,perform:null,staller:null},i=z();return s.perform=(async()=>{try{r.requests++;const o=await this._translatePerform(r.provider,t);s.result={result:o}}catch(o){r.errorResponses++,s.result={error:o}}const a=z()-i;r._totalTime+=a,r.rollingDuration=.95*r.rollingDuration+.05*a,s.perform=null})(),s.staller=(async()=>{await He(r.stallTimeout),s.staller=null})(),e.add(s),s}async#a(){let e=this.#r;if(!e){const t=[];this.#e.forEach(r=>{t.push((async()=>{await Qe(r,0),r._lastFatalError||(r._network=await r.provider.getNetwork())})())}),this.#r=e=(async()=>{await Promise.all(t);let r=null;for(const s of this.#e){if(s._lastFatalError)continue;const i=s._network;r==null?r=i.chainId:i.chainId!==r&&l(!1,"cannot mix providers on different networks","UNSUPPORTED_OPERATION",{operation:"new FallbackProvider"})}})()}await e}async#o(e,t){const r=[];for(const s of e)if(s.result!=null){const{tag:i,value:a}=j(s.result);r.push({tag:i,value:a,weight:s.config.weight})}if(!(r.reduce((s,i)=>s+i.weight,0)<this.quorum)){switch(t.method){case"getBlockNumber":{this.#t===-2&&(this.#t=Math.ceil(y(K(this.quorum,this.#e.filter(i=>!i._lastFatalError).map(i=>({value:i.blockNumber,tag:y(i.blockNumber).toString(),weight:i.weight}))))));const s=Xe(this.quorum,r);return s===void 0?void 0:(s>this.#t&&(this.#t=s),this.#t)}case"getGasPrice":case"getPriorityFee":case"estimateGas":return K(this.quorum,r);case"getBlock":return"blockTag"in t&&t.blockTag==="pending"?L(this.quorum,r):U(this.quorum,r);case"call":case"chainId":case"getBalance":case"getTransactionCount":case"getCode":case"getStorage":case"getTransaction":case"getTransactionReceipt":case"getLogs":return U(this.quorum,r);case"broadcastTransaction":return L(this.quorum,r)}l(!1,"unsupported method","UNSUPPORTED_OPERATION",{operation:`_perform(${D(t.method)})`})}}async#i(e,t){if(e.size===0)throw new Error("no runners?!");const r=[];let s=0;for(const a of e){if(a.perform&&r.push(a.perform),a.staller){r.push(a.staller);continue}a.didBump||(a.didBump=!0,s++)}const i=await this.#o(e,t);if(i!==void 0){if(i instanceof Error)throw i;return i}for(let a=0;a<s;a++)this.#s(e,t);return l(r.length>0,"quorum not met","SERVER_ERROR",{request:"%sub-requests",info:{request:t,results:Array.from(e).map(a=>D(a.result))}}),await Promise.race(r),await this.#i(e,t)}async _perform(e){if(e.method==="broadcastTransaction"){const i=this.#e.map(c=>null),a=this.#e.map(async({provider:c,weight:u},m)=>{try{const f=await c._perform(e);i[m]=Object.assign(j({result:f}),{weight:u})}catch(f){i[m]=Object.assign(j({error:f}),{weight:u})}});for(;;){const c=i.filter(f=>f!=null);for(const{value:f}of c)if(!(f instanceof Error))return f;const u=U(this.quorum,i.filter(f=>f!=null));if(ce(u,"INSUFFICIENT_FUNDS"))throw u;const m=a.filter((f,g)=>i[g]==null);if(m.length===0)break;await Promise.race(m)}const o=L(this.quorum,i);if(l(o!==void 0,"problem multi-broadcasting","SERVER_ERROR",{request:"%sub-requests",info:{request:e,results:i.map(D)}}),o instanceof Error)throw o;return o}await this.#a();const t=new Set;let r=0;for(;;){const i=this.#s(t,e);if(i==null||(r+=i.config.weight,r>=this.quorum))break}const s=await this.#i(t,e);for(const i of t)i.perform&&i.result==null&&i.config.lateResponses++;return s}async destroy(){for(const{provider:e}of this.#e)e.destroy();super.destroy()}}function Ye(n){return n&&typeof n.send=="function"&&typeof n.close=="function"}const et="goerli kovan sepolia classicKotti optimism-goerli arbitrum-goerli matic-mumbai bnbt".split(" ");function tt(n,e){e==null&&(e={});const t=a=>e[a]==="-"?!1:typeof e.exclusive=="string"?a===e.exclusive:Array.isArray(e.exclusive)?e.exclusive.indexOf(a)!==-1:!0;if(typeof n=="string"&&n.match(/^https?:/))return new k(n);if(typeof n=="string"&&n.match(/^wss?:/)||Ye(n))return new fe(n);let r=null;try{r=b.from(n)}catch{}const s=[];if(t("publicPolygon")&&r&&r.name==="matic"&&s.push(new k("https://polygon-rpc.com/",r,{staticNetwork:r})),t("alchemy"))try{s.push(new A(n,e.alchemy))}catch{}if(t("ankr")&&e.ankr!=null)try{s.push(new B(n,e.ankr))}catch{}if(t("cloudflare"))try{s.push(new Ie(n))}catch{}if(t("etherscan"))try{s.push(new Ae(n,e.etherscan))}catch{}if(t("infura"))try{let a=e.infura,o;typeof a=="object"&&(o=a.projectSecret,a=a.projectId),s.push(new P(n,a,o))}catch{}if(t("quicknode"))try{let a=e.quicknode;s.push(new M(n,a))}catch{}if(l(s.length,"unsupported default network","UNSUPPORTED_OPERATION",{operation:"getDefaultProvider"}),s.length===1)return s[0];let i=Math.floor(s.length/2);return i>2&&(i=2),r&&et.indexOf(r.name)!==-1&&(i=1),e&&e.quorum&&(i=e.quorum),new Ze(s,void 0,{quorum:i})}class me extends Se{#e;constructor(e,t){h(e&&e.request,"invalid EIP-1193 provider","ethereum",e),super(t,{batchMaxCount:1}),this.#e=async(r,s)=>{const i={method:r,params:s};this.emit("debug",{action:"sendEip1193Request",payload:i});try{const a=await e.request(i);return this.emit("debug",{action:"receiveEip1193Result",result:a}),a}catch(a){const o=new Error(a.message);throw o.code=a.code,o.data=a.data,o.payload=i,this.emit("debug",{action:"receiveEip1193Error",error:o}),o}}}async send(e,t){return await this._start(),await super.send(e,t)}async _send(e){h(!Array.isArray(e),"EIP-1193 does not support batch request","payload",e);try{const t=await this.#e(e.method,e.params||[]);return[{id:e.id,result:t}]}catch(t){return[{id:e.id,error:{code:t.code,data:t.data,message:t.message}}]}}getRpcError(e,t){switch(t=JSON.parse(JSON.stringify(t)),t.error.code||-1){case 4001:t.error.message=`ethers-user-denied: ${t.error.message}`;break;case 4200:t.error.message=`ethers-unsupported: ${t.error.message}`;break}return super.getRpcError(e,t)}async hasSigner(e){e==null&&(e=0);const t=await this.send("eth_accounts",[]);return typeof e=="number"?t.length>e:(e=e.toLowerCase(),t.filter(r=>r.toLowerCase()===e).length!==0)}async getSigner(e){if(e==null&&(e=0),!await this.hasSigner(e))try{await this.#e("eth_requestAccounts",[])}catch(t){const r=t.payload;throw this.getRpcError(r,{id:r.id,error:t})}return await super.getSigner(e)}}async function rt(n){const e=[{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],type:"function"}];try{const r=await new me(window.ethereum).getSigner(),s="0x4b48c0db4e460c894bfc031d602a5c3b57a26857",a=await new ue(s,e,r).balanceOf(n),o=he(a,18);return console.log(o),o}catch(t){console.error("Error:",t)}}document.getElementById("login");let ne=null,q,J;async function ot(){window.ethereum==null?(console.log("MetaMask not installed; using read-only defaults"),q=tt(),alert("Metamask Not Installed")):(q=new me(window.ethereum),ne=await q.getSigner(),J=await ne.getAddress(),ie.set(!0),ae.set(!0),localStorage.setItem("accountAddress",J),location.reload());const n=await rt(J);ge.setKey("balance",parseFloat(n).toFixed(2))}async function ct(){ie.set(!1),ae.set(!1),localStorage.removeItem("accountAddress"),location.reload()}export{me as B,ot as a,rt as c,at as f,tt as g,ct as l,it as p};
